<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="author"   content="Gilberto Garc&#237;a"/>
        <meta name="mod-date" content="03/31/2013"/>		
        <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black" />
        <title>
        </title>
		<style>
		.splash {
                 align: center;
                }
		</style>
		<!--http://jsfiddle.net/frankdenouter/Lp9P2/-->
		<style>
table {
    color: black;
    background: #fff;
    border: 1px solid #b4b4b4;
    font: bold 17px helvetica;
    padding: 0;
    margin-top:10px;
    width: 100%;
    -webkit-border-radius: 8px;
}
     
table tr td {
    color: #666;
    border-bottom: 1px solid #b4b4b4;
    border-right: 1px solid #b4b4b4;
    padding: 10px 10px 10px 10px;
    background-image: -webkit-linear-gradient(top, #fdfdfd, #eee);
}
         
table tr td:last-child {
    border-right: none;
}

table tr:last-child td {
    border-bottom: none;
}		
		</style>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
        <script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
		<!-- http://jsfiddle.net/jerone/gsNzT/ -->
		<script>
/*\
Animate collapsible set;
\*/
$(document).one("pagebeforechange", function() {

    // animation speed;
    var animationSpeed = 200;

    function animateCollapsibleSet(elm) {

        // can attach events only one time, otherwise we create infinity loop;
        elm.one("expand", function() {

            // hide the other collapsibles first;
            $(this).parent().find(".ui-collapsible-content").not(".ui-collapsible-content-collapsed").trigger("collapse");

            // animate show on collapsible;
            $(this).find(".ui-collapsible-content").slideDown(animationSpeed, function() {

                // trigger original event and attach the animation again;
                animateCollapsibleSet($(this).parent().trigger("expand"));
            });

            // we do our own call to the original event;
            return false;
        }).one("collapse", function() {

            // animate hide on collapsible;
            $(this).find(".ui-collapsible-content").slideUp(animationSpeed, function() {

                // trigger original event;
                $(this).parent().trigger("collapse");
            });

            // we do our own call to the original event;
            return false;
        });
    }

    // init;
    animateCollapsibleSet($("[data-role='collapsible-set'] > [data-role='collapsible']"));
});
		</script>
		

		<script>
		$(function () {
    setTimeout(hideSplash, 2000);
});

function hideSplash() {
    $.mobile.changePage("#main-page", "fade");
}
		</script>
		
        <script>
            try {

    $(function() {

    });

  } catch (error) {
    console.error("Your javascript has an error: " + error);
  }
    </script>

	<!-- Weather data from Wunderground, http://www.wunderground.com/weather/api/ -->
    <script>
	var Wunderground_Key_ID = "Your Wunderground Key ID";
	var ZipCode = "Your Zip code";
jQuery(document).ready(function($) {
  $.ajax({
  url : "http://api.wunderground.com/api/" + Wunderground_Key_ID + "/conditions/forecast10day/q/" + ZipCode + ".json",
  dataType : "jsonp",
  success : function(parsed_json) {

  var temp_f = parsed_json['current_observation']['temp_f'] + '&#8457;' ;
  var current_conditions = parsed_json['current_observation']['weather']  ;
  var location = parsed_json['current_observation']['display_location']['full'];
  var icon_url_current = parsed_json['current_observation']['icon_url'];

  var image_current = "<img src=\""+ icon_url_current +"\" width=\"40\" height=\"40\" >";
  
  var forecast = parsed_json['forecast']['simpleforecast']['forecastday'];
  for (index in forecast)
  {
    var counter = parseInt(forecast[index]['period']);
    var image = "<img src=\""+ forecast[index]['icon_url'] +"\" width=\"40\" height=\"40\" >";
    var highAndLows = "<b>" + forecast[index]['high']['fahrenheit'] +"</b>"+ "|" + forecast[index]['low']['fahrenheit'] + ' &#8457; ';

	//today
	if(counter == 1){
	$("#c_forecast").append("<br/><td align=\"left\"><b>[" + counter + "] " +  image + forecast[index]['date']['weekday']  + "</b> " + highAndLows + forecast[index]['conditions'] + ", chance of precipitation " + forecast[index]['pop'] + "%.</td>") ;
	$("#c_current_precipitation").append("<center><b><font size=\"6\">" + forecast[index]['pop'] + "%</font></b></center>");
	$("#c_extforecast").append("<br/><td align=\"left\"><b>[" + counter + "] " +  image + forecast[index]['date']['weekday']  + "</b> " + highAndLows + forecast[index]['conditions'] + ", chance of precipitation " + forecast[index]['pop'] + "%.</td>") ;
	}
	//3 day forecast
	else if (counter <=4){
	$("#c_forecast").append("<br/><td align=\"left\"><b>[" + counter + "] " +  image + forecast[index]['date']['weekday']  + "</b> " + highAndLows + forecast[index]['conditions'] + ", chance of precipitation " + forecast[index]['pop'] + "%.</td>") ;
	$("#c_extforecast").append("<br/><td align=\"left\"><b>[" + counter + "] " +  image + forecast[index]['date']['weekday']  + "</b> " + highAndLows + forecast[index]['conditions'] + ", chance of precipitation " + forecast[index]['pop'] + "%.</td>") ;
	}
	//extended forecast
	else{
	$("#c_extforecast").append("<br/><td align=\"left\"><b>[" + counter + "] " +  image + forecast[index]['date']['weekday']  + "</b> " + highAndLows + forecast[index]['conditions'] + ", chance of precipitation " + forecast[index]['pop'] + "%.</td>") ;
	}
  }
  
  $("#c_current_conditions").append("<br><center>"+image_current+"<br><b>" + current_conditions +"</b></center>");
  $("#c_location").append("<b>" + location +"</b>");
  $("#c_temperature").append("<br><center><b><font size=\"6\">" + temp_f + "</font></b></center>");
  }
  });
});
    </script>

    </head>
    <body>
	    <div data-role="page" data-theme="b" id="splash" style="background-color: #fff;"> 
            <div class="splash">
				<img src="http://yourRpiServer/images/Splash_640_400.png" alt="splash" />
            </div>
        </div>
		
        <!-- Home -->
        <div data-role="page" id="main-page" data-theme="b" data-content-theme="b">
            <div data-theme="b" data-role="header" >
                <h3>
                    HomeAlarmPlus Pi
                </h3>
            </div>
            <div data-role="content">
        <div data-role="collapsible-set" data-theme="c" data-content-theme="e">
            <div data-theme="c" data-role="collapsible" data-iconpos="right" data-collapsed="false">
                <h3>
                    Alarm Panel [Netduino Plus]
                </h3>
                <ul data-role="listview" data-divider-theme="b" data-inset="true">
                    <li data-theme="c">
                        <a href="http://yourNetduinoPlusServer/mobile" rel="external" data-transition="slide">
                            Home
                        </a>
                    </li>
                </ul>
                <ul data-role="listview" data-divider-theme="b" data-inset="true">
                    <li data-theme="c">
                        <a href="http://yourNetduinoPlusServer/diag-mobile" rel="external" data-transition="slide">
                            Diagnostics
                        </a>
                    </li>
                </ul>				
                <ul data-role="listview" data-divider-theme="b" data-inset="true">
                    <li data-theme="c">
                        <a href="http://yourNetduinoPlusServer/about-mobile" rel="external" data-transition="slide">
                            About HomeAlarmPlus
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <ul data-role="listview" data-divider-theme="b" data-inset="true">
            <li data-theme="c">
                <a href="#weather" data-transition="slide">
                    Weather
                </a>
            </li>
        </ul>		
        <ul data-role="listview" data-divider-theme="b" data-inset="true">
            <li data-theme="c">
                <a href="http://yourRpiServer/sysinfo_v2/index.php" rel="external" data-transition="slide">
                    System Info
                </a>
            </li>
        </ul>
        <ul data-role="listview" data-divider-theme="b" data-inset="true">
            <li data-theme="c">
                <a href="#about" data-transition="slide">
                    About HomeAlarmPlus Pi
                </a>
            </li>
        </ul>
		
            </div>	
            <div data-role="footer" class="footer-docs" data-theme="c">
		        <p class="jqm-version"></p>
		        <p>Copyright 2012, 2013 Gilberto Garc&#237;a</p>
	        </div>			
        </div><!-- /main-page -->
		
        <div data-role="page" id="weather" data-add-back-btn="true" data-theme="b" data-content-theme="b">
            <div data-theme="b" data-role="header">
                <h3>
                    Weather
                </h3>
				<div data-role="content"><p id="c_location">Location: </p></div>
            </div>			
            <div data-role="collapsible-set" data-content-theme="e">
               <div data-theme="c" data-role="collapsible" data-collapsed="false">
                  <h3>
                     Currently
                  </h3>
				  <table  border="0"  >
		             <tr>
                        <td id="c_current_conditions"></td>
				        <td id="c_temperature"><center>Temperature</center></td>
						<td id="c_current_precipitation"><center>Chance of<br>precipitation</center></td>
				    </tr> 
	              </table>
               </div>			
               <div data-theme="c" data-role="collapsible">
                  <h3>
                     3 day Forecast
                  </h3>
			      <table class="gridtable" border="0" width="100%">
			         <tr>
				        <td><center>Forecast</center></td>
			         </tr>				  
			         <tr>
				        <td id="c_forecast"></td>
			         </tr>
	              </table>
               </div>
               <div data-theme="c" data-role="collapsible" >
                  <h3>
                     10 day Forecast
                  </h3>
			      <table class="gridtable" border="0" width="100%">
			         <tr>
				        <td><center>Forecast</center></td>
			         </tr>				  				  
			         <tr>
				        <td id="c_extforecast"></td>
			         </tr>
	              </table>
               </div>
           </div>
		   <div data-role="footer" class="footer-docs" data-theme="c">
		       <p class="jqm-version"></p>
		       <p>Copyright 2012, 2013 Gilberto Garc&#237;a</p>
	       </div>		   
        </div><!-- /weather page -->
		
        <div data-role="page" id="about" data-add-back-btn="true" data-theme="b" data-content-theme="b">
            <div data-theme="b" data-role="header" >
                <h3>
                    About
                </h3>
				<div data-role="content">
				    <div class="content-primary">
				        <h2>HomeAlarmPlus Pi</h2>
				        <p>Programmed by Gilberto Garc&#237;a</p>
						<p>Weather data from <a href="http://www.wunderground.com/" rel="external">Wunderground.com.</a></p>
				        <p>For latest source code visit: <a href="https://github.com/ferraripr/HomeAlarmPlusPi" rel="external">Repository</a></p>
				    </div>
				</div>
            </div>		
        </div>		
		<br>
    </body>
</html>
